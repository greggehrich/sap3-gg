<%= form_for @story do |f| %>
    <br>
    <!-- TODO: you needs to test for errors from the nested URLs also -->
    <% if @story.errors.any? %>
        <div id="error_explanation">
          <h2><%= pluralize(@story.errors.count, "error") %> prohibited this story from being saved:</h2>
          <ul>
            <% @story.errors.full_messages.each do |message| %>
                <li><%= message %></li>
            <% end %>
          </ul>
        </div>
    <% end %>

    <%= f.fields_for :urls do |u| %>

        <div class="form-group">
          <div class="panel panel-default">
            <div class="panel-body">
              <table class="table-responsive table-condensed">
                <tr>
                  <td>Page URL</td>
                  <td><%= u.text_field :url_full, :value => @source_url_pre, :readonly => true, :size => 100 %></td>
                  <td></td>
                </tr>
                <tr>
                  <td>Domain</td>
                  <td><%= u.text_field :url_domain, :value => @base_domain, :readonly => true, :size => 35 %>
                    &nbsp;&nbsp;URL Type &nbsp;&nbsp;<%= u.select :url_type, ["Media"] %></td>
                  <td></td>
                </tr>
                <tr>
                  <td>URL Title</td>
                  <td><%= u.text_area :url_title, rows: 1, :value => @title, :maxlength => 250, style:"width: 825px" %></td>
                  <td></td
                </tr>
                <tr>
                  <td>URL Desc</td>
                  <td><%= u.text_area :url_desc, rows: 3, :value => @meta_desc, :maxlength => 1000, style:"width: 825px" %></td>
                  <td></td>
                </tr>
                <tr>
                  <td>URL Keywords</td>
                  <td><%= u.text_area :url_keywords, rows: 1, :value => @meta_keywords, :maxlength => 1000, style:"width: 825px" %></td>
                  <td></td>
                </tr>
                <%= u.hidden_field :raw_url_title_scrape, :value => @title %>
                <%= u.hidden_field :raw_url_desc_scrape, :value => @meta_desc %>
                <%= u.hidden_field :raw_url_keywords_scrape, :value => @meta_keywords %>
              </table>
            </div></div>
        </div>

        <%= f.fields_for :images do |i| %>
            <% zzz = "http://www.gannett-cdn.com/-mm-/c3e677c550ca4edc0dfa387fcca6f816a7ff22c1/c=0-0-1995-1500&r=x513&c=680x510/local/-/media/USATODAY/USATODAY/2014/09/16/1410887792000-Hard Rock Exterior_Photo Credit Hard Rock Hotel.jpg" %>
            <% bbb = "http://www.travelandleisure.com/images/amexpub/0043/4121/201406-w-ultimate-bacon-guide-barbacon-article.jpg" %>
            <% ccc = "http://i.kinja-img.com/gawker-media/image/upload/s--tbU9kbzw--/c_fit,fl_progressive,q_80,w_636/q8mnfcdlmqjcxggvgolw.jpg" %>
            <div class="form-group">
              <div class="panel panel-default">
                <div class="panel-body">
                  <div class="container-fluid">
                    <div class="row">
                      <div class="col-md-1 text-right">
                        <%= i.radio_button :src_url, "1" %>
                      </div>
                      <div class="col-md-2">
                        <%= i.label(:src_url_1, " Vegas Baby. It's all here in the hot summer sun!") %>
                      </div>
                      <div class="col-md-2">
                        <%= image_tag(zzz, width: "250", alt: "Vegas Baby") %><br>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-1 text-right">
                        <%= i.radio_button :src_url, "2" %>
                      </div>
                      <div class="col-md-2">
                        <%= i.label(:src_url_2, "Bacon bacon! Get it while it's hot, crispy and good! Yeah baby!", size: 25) %>
                      </div>
                      <div class="col-md-2">
                        <%= image_tag(bbb, width: "250", alt: "Bacon") %><br>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-1 text-right">
                        <%= i.radio_button :src_url, "3" %>
                      </div>
                      <div class="col-md-2">
                        <%= i.label(:src_url_3, "Grab your motocross bike and hit the trail for fun, exercise and maybe even some pain. I'm going to make this description extra long to see what happens.") %>
                      </div>
                      <div class="col-md-2">
                        <%= image_tag(ccc, width: "250", alt: "Bike") %>
                      </div>
                    </div>

                      <% @page_imgs.each do |key,array| %>
                          <div class="row">
                            <div class="col-md-1 text-right">
                              <%= i.radio_button :src_url, key %>
                            </div>
                            <div class="col-md-2">
                              <% src_url_key = ":src_url_" + key.to_s %>
                              <%= i.label( :src_url_key, @page_imgs[key]["alt_text"]) %>
                            </div>
                            <div class="col-md-2">
                              <%= image_tag(@page_imgs[key]["src_url"], width: "250") %><br>
                            </div>
                          </div>
                      <% end %>


                    </div>
                  </div>#
                </div></div>
            </div>

        <% end %>

    <% end %>

    <div class="panel panel-default">
      <div class="panel-body">
        <table class="table-responsive table-condensed">
          <tr>
            <td>Editor Tagline </td>
            <td>  <%= f.text_field :editor_tagline, :placeholder => "Maximum 60 chars", :maxlength => 60, :size => 60 %>  </td>
          </tr>
          <tr>
            <td>Location</td>
            <td><span  class="has-popover" data-toggle="popover" data-placement="bottom" title="Location Codes" data-html="true" data-trigger="focus"
                                       data-content= "<%= raw location_options %>" >
                    <%= f.text_field :location_code, :onkeyup => "this.value = this.value.toUpperCase();",
                    :placeholder => "Comma separated location codes", :size => 50 %></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
               <span  class="has-popover" data-toggle="popover" data-placement="bottom" title="Category Codes" data-html="true" data-trigger="focus"
                                       data-content= "<%= raw category_options %>" >
                    Category&nbsp;&nbsp;<%= f.text_field :category_code, :onkeyup => "this.value = this.value.toUpperCase();",
                    :placeholder => "Comma separated category codes", :size => 30 %></span>
            </td>
            <td></td>
          </tr>
          <tr>
            <td>Scraped Type</td>
            <td><%= f.text_field :scraped_type, :value => @meta_type, size:20, :readonly => true %>&nbsp;&nbsp;&nbsp;Story Type
              <%= f.select :story_type, ["Magazine", "Newspaper", "Blog", "Internet", "Television", "Wheres URL Original",
                                         "Promotional", "Collection", "Affiliate", "CVB Publication", "Film", "Radio",
                                         "Guide", "Hotel Guide", "Book", "Industry Awards"] %></td>
          </tr>
          <tr>
            <td>Story Author</td>
            <td><%= f.text_field :author, :value => @meta_author, :size => 50 %></td>
          </tr>
          <tr>
            <td>Story Date</td>
            <td><%= f.number_field :story_year, :value => @year, :placeholder => "yyyy", in: 2000...2020, :style => "text-align: center"  %>
              <%= f.number_field :story_month, :value => @month, :placeholder => "mm", in: 1...13, :style => "text-align: center"  %>
              <%= f.number_field :story_date, :value => @day, :placeholder => "dd", in: 1...32, :style => "text-align: center" %>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<%= f.submit "Save", class: 'btn btn-sm btn-success' %></td>
          </tr>
          <%= f.hidden_field :raw_author_scrape, :value => @meta_author %>
          <%= f.hidden_field :raw_story_year_scrape, :value => @year %>
          <%= f.hidden_field :raw_story_month_scrape, :value => @month %>
          <%= f.hidden_field :raw_story_date_scrape, :value => @day %>
        </table>
      </div></div>

    <%= debug(params) if Rails.env.development? %>
    <%= debug(flash) if Rails.env.development? %>

    <iframe class="embed-responsive-item" sandbox="allow-forms allow-scripts" src="<%= @full_web_url %>" frameborder="3" width="100%" height="600px">error!</iframe>
<% end %>
